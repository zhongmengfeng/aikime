<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>Hello MUI</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="stylesheet" href="css/mui.min.css">
		<link rel="stylesheet" href="css/myown_center_01.css" />
		<link rel="stylesheet" href="css/yiji02.css">
		<link rel="stylesheet" href="css/body_decks.css" />
		<style>
			.btn-detail {
				border-radius: 15px;
				font-weight: 600;
				line-height: 20px;
				margin-top: 3px;
				font-size: 14px;
			}
			.mui-table-view-cell.mui-collapse.mui-active {
			    margin-top: 0;
			}
			.mui-table-view-cell.mui-active {
			     background-color: #fff; 
			}
			.btn-download {
				height: 44px;
				padding: 0;
				line-height: 44px;
				width: 95%;
				border-radius: 10px;
			}
			label {
				font-size: 15px;
			}
			.mui-bar-nav {
			     -webkit-box-shadow: 0 0 0 transparent !important; 
			     box-shadow: 0 0 0 transparent !important; 
			}
			.listUl{
				margin: 0 15px;	
				border-radius: 7px;
				padding: 2px 15px;
				top:15px;
			}
			.listUl li{
				padding: 8px 15px;
				border-bottom: 1px solid #d5d8dd;
			}
			.listUl li:last-child{
				border-bottom: 0 !important;	
			}
			.listUl li .download{
				height: 24px;
				position: absolute;
			    top: 10px;
			    right: 16px;
			}
			.listUl li:first-child .download{
				top:12px;
			}
			.photo{
				height: 11px;
				margin-top: 4px;
				padding-left: 20px;
			}
			.mui-table-view:before,.mui-table-view:after{
				background-color:transparent !important;
			}
			.square{
				width: 5px;
				height: 5px;
				background: #ac92ec;
				float: left;
				margin-top: 7px;
				border-radius: 1px;
			}
			.testFont{
				float: left;
				padding-left:10px ;
				font-size: 15px;
				color: #0c0e10;
				line-height:24px ;
				width: 60%;
			}

			.testFont p{
				font-size:10px ;
				color: #a8a9a9;
				line-height: 14px;
				height:14px;
				margin-bottom: 3px;
			}
			.mui-table-view-cell>a:not(.mui-btn) {
				margin: -11px -30px !important;
			}
			.mui-table-view-cell:after {
				height: 0 !important;
			}
			.return{
				width: 100px;
				height: 44px;
				display:inline-block;
			}
			.changeColor{
				height:63px;
				background-color: #444a59;
				position: absolute;
				width: 100%;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
		    <span class="return"><img src="images/returnIcon.png" class="home-return" /></span>
		    <h1 class="mui-title" style="color: white;">共享文章</h1>
		</header>
		<div class="mui-content">
			<div class="changeColor"></div>
			<ul class="mui-table-view listUl" id="listUl"></ul>
		    <!--
			<div class="mui-card" style="padding-bottom: 0px; margin-bottom: 2px;">
				<ul class="mui-table-view">
				    <li class="mui-table-view-cell mui-media mui-collapse">
				        <a href="javascript:;">
				            <img class="mui-media-object mui-pull-left" src="images/read01.png">
				            <div class="mui-media-body mui-pull-left" style="width: 45%;">
				                四级阅读01
				                <p class="mui-ellipsis">内含2300常用单词，包括音频动画</p>
				            </div>
				            <div class="mui-media-body mui-pull-right" style="width: 60px;">
				                <button type="button" class="mui-btn mui-btn-green mui-btn-outlined btn-detail">详情</button>
				            </div>
				        </a>
				        <div class="mui-collapse-content style="padding-bottom: 0;"">
							<div class="mui-input-group style="padding-bottom: 0;"">
							    <div class="mui-input-row">
							        <label>上传日前：</label>
							        <input type="text" class="mui-input-clear" placeholder="2016-1-3" disabled="true"> 
							    </div>
							    <div class="mui-input-row">
							        <label>下载次数：</label>
							        <input type="text" class="mui-input-clear" placeholder="14" disabled="true">
							    </div>
							    <div class="mui-input-row">
							        <label>文件大小：</label>
							        <input type="text" class="mui-input-clear" placeholder="34.5mb" disabled="true">
							    </div>
							    <div class="" style="text-align: center; padding-left: 5%;padding-top: 10px;">
							        <button type="button" class="mui-btn mui-btn-green mui-btn-block btn-download">点击下载</button>
							    </div>
							</div>
						</div>
				    </li>
				</ul>
			</div>
            -->
			
			
		</div>
		<script src="js/mui.min.js"></script>
		<script>
			mui.init();
//			var listDataStr = '[["sijiReading_001", "http:\/\/www.ankichina.net\/RawDecks\/Decks\/2016-07-19\/sijiReading_001.txt"]]';
			
			var listDataStr = '[{"addtime":"2017-04-01 11:09:33","goods_id":"1723","title":"四级阅读001@@@1","short_desc":"英语四级文章","url":"http:\/\/anki.oss-cn-hangzhou.aliyuncs.com\/Uploads\/201704011131\/%E5%9B%9B%E7%BA%A7%E9%98%85%E8%AF%BB001%40%40%401.txt","xia":"3"}]';
			var listData = JSON.parse(listDataStr);
			var listUl = document.getElementById('listUl');
			
			/////////////////bridge/////////////////////
			/**<js-ios>
				window.onerror = function(err) {
			        log('window.onerror: ' + err)
				}
			
			    function setupWebViewJavascriptBridge(callback) {
			        if (window.WebViewJavascriptBridge) {
			            return callback(WebViewJavascriptBridge);
			        }
			        if (window.WVJBCallbacks) {
			            return window.WVJBCallbacks.push(callback);
			        }
			        window.WVJBCallbacks = [callback];
			        var WVJBIframe = document.createElement('iframe');
			        WVJBIframe.style.display = 'none';
			        WVJBIframe.src = 'wvjbscheme://__BRIDGE_LOADED__';
			        document.documentElement.appendChild(WVJBIframe);
			        setTimeout(function() {
			            document.documentElement.removeChild(WVJBIframe)
			            }, 0);
			    }
			
			    setupWebViewJavascriptBridge(function(bridge) {
			        
			
			        bridge.registerHandler('initLayout', function(data, responseCallback) {
	                    
	                    //showlist(data);
	                                       
	                    initLayout(data, bridge);
	                    
	   		        });
			        bridge.registerHandler('changeTheme', function(data, responseCallback) {
	                  	changeAllColor(data);
		        	});
		            //bridge.callHandler('testObjcCallback', {'foo': 'bar'}, function(response) {
						//log('JS got response', response)
		            //});
			         
			    });
			</js-ios>**/
			
			/////////////////bridge/////////////////////
			
			function initLayout(serveData, bridge){

				if (serveData==null) {
					serveData = listData;
				}else{
					serveData = JSON.parse(serveData);
				}
				addBtnsListener(bridge);
				showlist(serveData);
				
			}
			
			function showlist(Data){
				//alert(33);
				//alert(Data.length);
				for (var i = 0; i < Data.length; i++) {
					var item = Data[i];
                    //alert(item);
					var temp1 = ["<li class=\"mui-table-view-cell\">"+ item[0],	
			        	"<button type=\"button\" location="+ item[1] +" class=\"mui-btn mui-badge-blue mui-btn-outlined\">下载</button>",
					"</li>"].join("");
					var temp ='<li class="mui-table-view-cell mui-media mui-collapse">'
							        +'<a href="javascript:;">'
							            +'<div class="square">'
							            +'</div>'
							            +'<div class="testFont mui-ellipsis">'
							                +item.title.split("@@@")[0]
							                +'<p style="font-size:13px;line-height:20px;height:20px;margin-bottom: 6px;"><span class="mui-ellipsis" style="display:inline-block;width:82%;">'+item.short_desc+'</span><img src="images/getIntoIcon.png" class="photo" /></p>'
							                +'<p class="mui-ellipsis">下载次数：'+item.xia+'</p>'
							                +'<p>上传时间：'+item.addtime+'</p>'
							            +'</div>'
							            +'<img src="images/download3.png" class="download" location="'+item.url+'" goods_id="'+item.goods_id+'"/>'
							        +'</a>'
							+'		    </li>';        
//							+'		        <div class="mui-collapse-content style="padding-bottom: 0;"">'
//							+'					<div class="mui-input-group style="padding-bottom: 0;"">'
//							+'					    <div class="mui-input-row">'
//							+'					        <label>上传日前：</label>'
//							+'					        <input type="text" class="mui-input-clear" placeholder="2016-1-3" disabled="true">'
//							+'					    </div>'
//							+'					    <div class="mui-input-row">'
//							+'					        <label>下载次数：</label>'
//							+'					        <input type="text" class="mui-input-clear" placeholder="14" disabled="true">'
//							+'					    </div>'
//							+'					    <div class="mui-input-row">'
//							+'					        <label>文件大小：</label>'
//							+'					        <input type="text" class="mui-input-clear" placeholder="34.5mb" disabled="true">'
//							+'					    </div>'
//							+'					    <div class="" style="text-align: center; padding-left: 5%;padding-top: 10px;">'
//							+'					        <button type="button" location="'+item[1]+'" class="mui-btn mui-btn-danger mui-btn-block btn-download">点击下载</button>'
//							+'					    </div>'
//							+'					</div>'
//							+'				</div>'
							
//					var temp = '<div class="mui-card" style="padding-bottom: 0px; margin-bottom: 2px;">'
//							+'		<ul class="mui-table-view">'
//							+'		    <li class="mui-table-view-cell mui-media mui-collapse">'
//							+'		        <a href="javascript:;">'
//							+'		            <img class="mui-media-object mui-pull-left" src="images/read01.png">'
//							+'		            <div class="mui-media-body mui-pull-left" style="width: 45%;">'
//							+ 		                item[0]
//							+'		                <p class="mui-ellipsis">内含2300常用单词，包括音频动画</p>'
//							+'		            </div>'
//							+'		            <div class="mui-media-body mui-pull-right" style="width: 60px;">'
//							+'		                <button type="button" class="mui-btn mui-btn-green mui-btn-outlined btn-detail">详情</button>'
//							+'		            </div>'
//							+'		        </a>'
//							+'		        <div class="mui-collapse-content style="padding-bottom: 0;"">'
//							+'					<div class="mui-input-group style="padding-bottom: 0;"">'
//							+'					    <div class="mui-input-row">'
//							+'					        <label>上传日前：</label>'
//							+'					        <input type="text" class="mui-input-clear" placeholder="2016-1-3" disabled="true">'
//							+'					    </div>'
//							+'					    <div class="mui-input-row">'
//							+'					        <label>下载次数：</label>'
//							+'					        <input type="text" class="mui-input-clear" placeholder="14" disabled="true">'
//							+'					    </div>'
//							+'					    <div class="mui-input-row">'
//							+'					        <label>文件大小：</label>'
//							+'					        <input type="text" class="mui-input-clear" placeholder="34.5mb" disabled="true">'
//							+'					    </div>'
//							+'					    <div class="" style="text-align: center; padding-left: 5%;padding-top: 10px;">'
//							+'					        <button type="button"  location="'+item[1]+'" class="mui-btn mui-btn-green mui-btn-block btn-download">点击下载</button>'
//							+'					    </div>'
//							+'					</div>'
//							+'				</div>'
//							+'		    </li>'
//							+'		</ul>'
//							+'	</div>';
					
					listUl.innerHTML += temp;
				}
			}
			
			
			
			function addBtnsListener(bridge){
				mui("#listUl").on('tap','.download',function(){
					//alert(111);
					var didName=[];
					did = this.getAttribute('location');
					goodsId = this.getAttribute("goods_id");
					didName.push(did);
					didName.push(goodsId);
					/**<js-ios>
						bridge.callHandler('downloadSingleItem', didName, function(response) {
							//log('JS got response', response)
			            });
					</js-ios>**/
					
						window.xuming.downloadSingleItem(didName);
					
				});
                
                
                mui("header").on('tap', '.return', function(){
                    //alert(1);
                    did=null;
                    /**<js-ios>
	                   	bridge.callHandler('backToParent', did, function(response) {
	                          //log('JS got response', response)
	                    });
                    </js-ios>**/
                    
                    	window.xuming.backToParent();
                    
                });
                
			}
			
						//主题色换肤
			var bgColor=document.getElementsByClassName('changeColor')[0];
			var titleBar=document.getElementsByClassName('mui-bar')[0];
			function changeAllColor(num){
				if(num==0){
					titleBar.style.backgroundColor='#444a59';
					bgColor.style.backgroundColor='#444a59';
				}else{
					
					titleBar.style.backgroundColor='#3696e9';
					bgColor.style.backgroundColor='#3696e9';
				}
				
			}
//			changeAllColor(1);

//			window.onload = initLayout(null, null);
			
		</script>
	</body>

</html>